<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<SharedFlow name="default">
    <Step>
        <Name>KVM-GetPrivateKey</Name>
    </Step>
    <Step>
        <Name>JWT-VerifyJWTAccessToken</Name>
    </Step>
    <Step>
        <Name>AM-SetHeaderParameters</Name>
    </Step>
    <Step>
        <Name>OA-VerifyAccessToken</Name>
    </Step>
    <Step>
        <Name>OA-InvalidateAccessToken</Name>
        <!--<Condition>(accesstoken.ip_address != proxy.client.ip || accesstoken.userId != "userId" || accesstoken.memberId != "memberId" || accesstoken.deviceId != deviceId)</Condition>-->
        <Condition>(accesstoken.ip_address != request.header.X-Forwarded-For)</Condition>
    </Step>
    <Step>
        <Name>SA-RequestThrottle</Name>
    </Step>
    <Step>
        <Name>CheckAPIQuota</Name>
    </Step>
    <Step>
        <Name>RE-DefaultAttacks</Name>
    </Step>
</SharedFlow>